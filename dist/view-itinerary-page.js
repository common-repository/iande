"use strict";(self.webpackChunkiande_plugin=self.webpackChunkiande_plugin||[]).push([[67],{5777:(t,e,a)=>{a.d(e,{Z:()=>i});const n={name:"ItemDetailsModal",components:{Modal:a(3498).Z},props:{item:{type:Object,required:!0}},computed:{image:function(){return this.item.attachments.find((function(t){return"image"===t.media_type}))}},methods:{close:function(){this.$refs.modal.isOpen&&this.$refs.modal.close()},open:function(){this.$refs.modal.open()}}};const i=(0,a(1900).Z)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{ref:"modal",staticClass:"iande-tainacan-modal",attrs:{label:t.__("Ficha da obra","iande")},on:{close:t.close}},[a("header",{staticClass:"iande-tainacan-modal__header"},[a("h1",[t._v(t._s(t.__("Mais detalhes sobre a obra","iande")))]),t._v(" "),a("a",{attrs:{href:t.item.url}},[a("span",[t._v(t._s(t._x("Ver item no","tainacan","iande"))+" "),a("b",[t._v("Tainacan")])]),t._v(" "),a("img",{attrs:{src:t.$iande.iandePath+"assets/img/tainacan-logo_short.png",alt:""}})])]),t._v(" "),a("main",{staticClass:"iande-tainacan-modal__details"},[t.image?a("dl",[a("dt",[t._v(t._s(t._x("Miniatura","tainacan","iande")))]),t._v(" "),a("dd",[a("a",{attrs:{href:t.image.url,target:"_blank"}},[a("img",{attrs:{src:t.image.thumbnails.thumbnail[0],alt:t._x("Miniatura","tainacan","iande")}})])])]):t._e(),t._v(" "),t._l(t.item.metadata,(function(e,n){return[e.value_as_html?a("dl",{key:n},[a("dt",[t._v(t._s(t._x(e.name,"tainacan","iande")))]),t._v(" "),a("dd",{domProps:{innerHTML:t._s(e.value_as_html)}})]):t._e()]}))],2),t._v(" "),a("footer",{staticClass:"iande-tainacan-modal__footer"},[a("a",{attrs:{href:t.item.url}},[a("span",[t._v(t._s(t._x("Ver item no","tainacan","iande"))+" "),a("b",[t._v("Tainacan")])]),t._v(" "),a("img",{attrs:{src:t.$iande.iandePath+"assets/img/tainacan-logo_short.png",alt:""}})])])])}),[],!1,null,null,null).exports},3498:(t,e,a)=>{a.d(e,{Z:()=>l});var n;var i=/^[~!&]*/,r=/\W+/,s={"!":"capture","~":"once","&":"passive"};function o(t){var e=t.match(i)[0];return(null==n?n=/msie|trident/.test(window.navigator.userAgent.toLowerCase()):n)?e.indexOf("!")>-1:e.split("").reduce((function(t,e){return t[s[e]]=!0,t}),{})}const c={name:"Modal",components:{GlobalEvents:{name:"GlobalEvents",props:{target:{type:String,default:"document"},filter:{type:Function,default:function(t){return!0}}},data:function(){return{isActive:!0}},activated:function(){this.isActive=!0},deactivated:function(){this.isActive=!1},render:function(t){return t()},mounted:function(){var t=this;this._listeners=Object.create(null),Object.keys(this.$listeners).forEach((function(e){var a=t.$listeners[e],n=function(n){t.isActive&&t.filter(n,a,e)&&a(n)};window[t.target].addEventListener(e.replace(r,""),n,o(e)),t._listeners[e]=n}))},beforeDestroy:function(){var t=this;for(var e in t._listeners)window[t.target].removeEventListener(e.replace(r,""),t._listeners[e],o(e))}}},props:{label:{type:String,required:!0},narrow:{type:Boolean,default:!1}},data:function(){return{isOpen:!1}},methods:{close:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isOpen=!1,t&&this.$emit("close")},open:function(){var t=this;this.isOpen=!0,this.$nextTick((function(){t.$refs.button.focus()}))}}};const l=(0,a(1900).Z)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isOpen?a("div",{staticClass:"iande-modal__wrapper"},[a("GlobalEvents",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.close.apply(null,arguments)}}}),t._v(" "),a("div",{staticClass:"iande-modal",class:{narrow:t.narrow},attrs:{role:"dialog","aria-modal":"true","aria-label":t.label,tabindex:"-1"}},[a("div",{staticClass:"iande-modal__header"},[a("div",{ref:"button",staticClass:"iande-modal__close",attrs:{role:"button",tabindex:"0","aria-label":t.__("Fechar","iande")},on:{click:t.close,keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.close.apply(null,arguments)}}},[a("Icon",{attrs:{icon:"xmark"}})],1)]),t._v(" "),a("div",{staticClass:"iande-modal__body"},[t._t("default")],2)])],1):a("div")}),[],!1,null,null,null).exports},7219:(t,e,a)=>{a.r(e),a.d(e,{default:()=>_});var n=a(7757),i=a.n(n),r=a(5777),s=a(1870);function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==a)return;var n,i,r=[],s=!0,o=!1;try{for(a=a.call(t);!(s=(n=a.next()).done)&&(r.push(n.value),!e||r.length!==e);s=!0);}catch(t){o=!0,i=t}finally{try{s||null==a.return||a.return()}finally{if(o)throw i}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return c(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function l(t,e,a,n,i,r,s){try{var o=t[r](s),c=o.value}catch(t){return void a(t)}o.done?e(c):Promise.resolve(c).then(n,i)}function d(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function s(t){l(r,n,i,s,o,"next",t)}function o(t){l(r,n,i,s,o,"throw",t)}s(void 0)}))}}const u={name:"ViewItineraryPage",components:{ItemDetailsModal:r.Z},data:function(){return{cover:!0,itemsCache:{},itinerary:null,page:0,shareAvailable:!0}},computed:{currentImage:function(){var t;return null===(t=this.currentMeta)||void 0===t?void 0:t.attachments.find((function(t){return"image"===t.media_type}))},currentItem:function(){return this.itinerary.items[this.page]},currentMeta:function(){var t;return null!==(t=this.itemsCache[this.page])&&void 0!==t?t:null},facebookLink:function(){return"https://www.facebook.com/sharer/sharer.php?quote=".concat(window.encodeURIComponent(this.shareText),"&u=").concat(window.location.href)},shareText:function(){return"".concat(this.itinerary.title,"\n\n").concat(this.itinerary.description)},telegramLink:function(){return"https://t.me/share/url?text=".concat(window.encodeURIComponent(this.shareText),"&url=").concat(window.encodeURIComponent(window.location.href))},twitterLink:function(){return"https://twitter.com/intent/tweet?text=".concat(window.encodeURIComponent(this.shareText),"&url=").concat(window.location.href)},whatsappLink:function(){return"https://api.whatsapp.com/send?text=".concat(window.encodeURIComponent("".concat(this.shareText,"\n\n").concat(window.location.href)))}},watch:{page:function(){this.fetchItem(this.page)}},beforeMount:function(){var t=this;return d(i().mark((function e(){var a,n,r,c,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.shareAvailable="function"==typeof window.navigator.share,!s.qs.has("ID")){e.next=25;break}return e.prev=2,a=s.qs.get("ID"),e.next=6,Promise.all([s.hi.get("itinerary/get/?ID=".concat(a,"&public=1")),s.hi.post("itinerary/view/?ID=".concat(a))]);case 6:if(n=e.sent,r=o(n,1),c=r[0],t.itinerary=c,l=window.location.hash?window.location.hash.slice(1):NaN,d=Number(l)-1,isNaN(d)||!c.items[d]){e.next=18;break}return e.next=15,t.fetchItem(d);case 15:t.gotoPage(d),e.next=20;break;case 18:return e.next=20,t.fetchItem(0);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(2),console.error(e.t0);case 25:case"end":return e.stop()}}),e,null,[[2,22]])})))()},methods:{fetchItem:function(t){var e=this;return d(i().mark((function a(){var n,r,c,l,d;return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.itemsCache[t]){a.next=10;break}return n=e.itinerary.items[t].items_id,a.next=4,Promise.all([s.hi.get("".concat(e.$iande.tainacanUrl,"/items/").concat(n)),s.hi.get("".concat(e.$iande.tainacanUrl,"/items/").concat(n,"/attachments"))]);case 4:r=a.sent,c=o(r,2),l=c[0],d=c[1],l.attachments=d,e.$set(e.itemsCache,t,l);case 10:case"end":return a.stop()}}),a)})))()},formatText:function(t){return t.trim().replace(/\r?\n/g,"<br/>")},gotoCover:function(){this.cover=!0,this.page=0,window.location.hash=""},gotoPage:function(t){this.cover=!1,this.page=t,window.location.hash="#".concat(t+1)},nextPage:function(){this.page===this.itinerary.items.length-1?this.gotoCover():this.gotoPage(this.page+1)},openModal:function(){this.$refs.modal&&this.$refs.modal.open()},previousPage:function(){0===this.page?this.gotoCover():this.gotoPage(this.page-1)},share:function(){var t={text:this.itinerary.description,title:this.itinerary.title,url:window.location.href};window.navigator.canShare(t)&&window.navigator.share(t)}}};const _=(0,a(1900).Z)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.itinerary?a("div",{staticClass:"iande-itinerary"},[t.cover?a("div",{staticClass:"iande-itinerary-cover"},[a("div",{staticClass:"iande-itinerary-cover__main",style:{"--itinerary-cover":"url("+t.itinerary.cover+")"}},[a("div",{staticClass:"iande-container"},[a("div",[a("div",{staticClass:"iande-itinerary-cover__lead"},[t._v(t._s(t.__("Roteiro virtual","iande")))]),t._v(" "),a("h1",{staticClass:"iande-itinerary-cover__title"},[t._v(t._s(t.itinerary.title))]),t._v(" "),a("p",{staticClass:"iande-itinerary-cover__description"},[t._v(t._s(t.formatText(t.itinerary.description)))]),t._v(" "),"yes"===t.itinerary.shareable?a("div",{staticClass:"iande-itinerary-cover__share"},[a("span",[t._v(t._s(t.__("Compartilhe","iande")))]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:t.facebookLink,target:"_blank","aria-label":"Facebook"}},[a("Icon",{attrs:{icon:["fab","facebook"]}})],1)]),t._v(" "),a("li",[a("a",{attrs:{href:t.telegramLink,target:"_blank","aria-label":"Telegram"}},[a("Icon",{attrs:{icon:["fab","telegram"]}})],1)]),t._v(" "),a("li",[a("a",{attrs:{href:t.twitterLink,target:"_blank","aria-label":"Twitter"}},[a("Icon",{attrs:{icon:["fab","twitter"]}})],1)]),t._v(" "),a("li",[a("a",{attrs:{href:t.whatsappLink,target:"_blank","aria-label":"WhatsApp"}},[a("Icon",{attrs:{icon:["fab","whatsapp"]}})],1)]),t._v(" "),t.shareAvailable?a("li",[a("a",{attrs:{href:"javascript:void(0)",role:"button",tabindex:"0","aria-label":t.__("Compartilhar","iande")},on:{click:t.share,keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.share.apply(null,arguments)}}},[a("Icon",{attrs:{icon:"share-nodes"}})],1)]):t._e()])]):t._e()]),t._v(" "),a("div",[a("button",{staticClass:"iande-button iande-itinerary-cover__start-button",on:{click:function(e){return t.gotoPage(0)}}},[t._v("\n                        "+t._s(t.__("Iniciar","iande"))+"\n                        "),a("Icon",{attrs:{icon:"angle-right"}})],1)])])]),t._v(" "),a("div",{staticClass:"iande-itinerary-cover__credits"},[a("div",{staticClass:"iande-container"},[a("div",[t._v(t._s(t.__("Roteiro criado por","iande"))+" "+t._s(t.itinerary.user_name))]),t._v(" "),a("div",[t._v(t._s(t.__("Obras pertencem à coleção de","iande"))+" "),a("b",[t._v(t._s(t.$iande.siteName))])])])])]):a("div",[a("div",{staticClass:"iande-itinerary-header"},[a("div",{staticClass:"iande-itinerary-toolbar"},[a("div",{staticClass:"iande-container iande-itinerary-toolbar__row"},[a("div",[a("span",[t._v(t._s(t.__("Roteiro de visita virtual","iande")))])]),t._v(" "),a("div",[a("span",[t._v(t._s(t.itinerary.title))])]),t._v(" "),a("div",[a("a",{attrs:{href:t.$iandeUrl("itinerary/list")}},[t._v("\n                            "+t._s(t.__("Fechar","iande"))+"\n                            "),a("Icon",{attrs:{icon:"xmark"}})],1)])])])]),t._v(" "),a("div",{staticClass:"iande-container"},[a("div",{staticClass:"iande-itinerary-navigation"},[a("button",{attrs:{"aria-label":0===t.page?t.__("Voltar à capa","iande"):t.__("Página anterior","iande")},on:{click:t.previousPage}},[a("Icon",{attrs:{icon:"angle-left"}})],1),t._v(" "),a("progress",{attrs:{max:t.itinerary.items.length},domProps:{value:t.page+1}},[t._v(t._s(t.page+1)+" / "+t._s(t.itinerary.items.length))]),t._v(" "),a("button",{attrs:{"aria-label":t.page===t.itinerary.items.length-1?t.__("Voltar à capa","iande"):t.__("Próxima página","iande")},on:{click:t.nextPage}},[a("Icon",{attrs:{icon:"angle-right"}})],1)]),t._v(" "),t.currentMeta?a("div",{staticClass:"iande-itinerary-page",class:"layout-"+t.itinerary.layout},[a("a",{staticClass:"iande-itinerary-page__image",attrs:{href:t.currentMeta.url}},[t.currentImage?a("img",{attrs:{src:t.currentImage.thumbnails.large[0],alt:t.currentImage.alt_text}}):t._e()]),t._v(" "),a("div",{staticClass:"iande-itinerary-page__details"},[a("div",{staticClass:"iande-itinerary-page__details-main"},[a("h2",{staticClass:"iande-itinerary-page__title"},[t._v(t._s(t.currentMeta.title))]),t._v(" "),a("p",{staticClass:"iande-itinerary-page__description"},[t._v(t._s(t.formatText(t.currentItem.items_description||t.currentMeta.description)))])]),t._v(" "),a("button",{staticClass:"iande-button primary",on:{click:t.openModal}},[a("Icon",{attrs:{icon:"circle-info"}}),t._v("\n                        "+t._s(t.__("Ver ficha completa da obra","iande"))+"\n                    ")],1)])]):t._e()])]),t._v(" "),t.currentMeta?a("ItemDetailsModal",{ref:"modal",attrs:{item:t.currentMeta}}):t._e()],1):t._e()}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=view-itinerary-page.js.map